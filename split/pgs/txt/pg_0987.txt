2

Background

Graphical models over strings are in fairly broad use. Linear-chain graphical models are equivalent to cascades of finite-state transducers, which have long been used to model stepwise derivational processes such as speech production (Pereira and Riley, 1997) and transliteration (Knight and Graehl, 1998). Treeshaped graphical models have been used to model the evolution and speciation of word forms, in order to reconstruct ancient languages (Bouchard-Côté et al., 2007; Bouchard-Côté et al., 2008) and discover cognates in related languages (Hall and Klein, 2010; Hall and Klein, 2011). Cyclic graphical models have been used to model morphological paradigms (Dreyer and Eisner, 2009; Dreyer and Eisner, 2011) and to reconstruct phonological underlying forms (Cotterell et al., 2015). All of these graphical models, except Dreyer's, happen to be directed ones. And all of these papers, except Bouchard-Côté's, use deterministic inference methods--based on BP. 2.1 Graphical models over strings

all paths that accept the d-tuple of strings, where a path's weight is the product of its arcs' weights. So our model marginalizes over possible paths in F . 2.2 Inference by (loopy) belief propagation Inference seeks the posterior marginal probabilities p(Vi = v | observations), for each i. BP is an iterative procedure whose "normalized beliefs" converge to exactly these marginals if the factor graph is acyclic (Pearl, 1988). In the cyclic case, the normalized beliefs still typically converge and can be used as approximate marginals (Murphy et al., 1999). A full presentation of BP for graphical models over strings can be found in Dreyer and Eisner (2009). We largely follow their notation. N (X ) represents the set of neighbors of X in the factor graph. For each edge in the factor graph, between a factor F and a variable V , BP maintains two messages, µV F and µF V . Each of these is a function over the possible values v of variable V , mapping each v to a non-negative score. BP also maintains another such function, the belief bV , for each variable V . In general, each message or belief should be regarded as giving only relative scores for the different v . Rescaling it by a positive constant would only result in rescaling other messages and beliefs, which would not change the final normalized beliefs. The normalized belief is the probability distribution ^ bV ^ such that each bV (v ) is proportional to bV (v ). The basic BP algorithm is just to repeatedly select and update a function until convergence. The rules for updating µV F , µF V , and bV , given the set of "neighboring" messages in each case, can be found as equations (2)­(4) of Dreyer and Eisner (2009). (We will give the EP variants in section 4.) Importantly, that paper shows that for graphical models over strings, each BP update can be implemented via standard finite-state operations of composition, projection, and intersection. Each message or belief is represented as a weighted finite-state acceptor (WFSA) that scores all strings v   . 2.3 The need for approximation BP is generally only used directly for short cascades of finite-state transducers (Pereira and Riley, 1997; Knight and Graehl, 1998). Alas, in other graphical models over strings, the BP messages--which are acceptors--become too large to be practical.

A directed or undirected graphical model describes a joint probability distribution over a set of random variables. To perform inference given a setting of the model parameters and observations of some variables, it is convenient to construct a factor graph (Kschischang et al., 2001). A factor graph is a finite bipartite graph whose vertices are the random variables {V1 , V2 , . . .} and the factors {F1 , F2 , . . .}. Each factor F is a function of the variables that it is connected to; it returns a non-negative real number that depends on the values of those variables. We define our factor graph so that the posterior probability p(V1 = v1 , V2 = v2 , . . . | observations), as defined by the original graphical model, can be computed as proportional to the product of the numbers returned by all the factors when V1 = v1 , V2 = v2 , . . .. In a graphical model over strings, each random variable V is permitted to range over the strings  where  is a fixed alphabet. As in previous work, we will assume that each factor F connected to d variables is a d-way rational relation, i.e., a function that can be computed by a d-tape weighted finite-state acceptor (Elgot and Mezei, 1965; Mohri et al., 2002; Kempe et al., 2004). The weights fall in the semiring (R, +, ×): F 's return value is the total weight of 933

